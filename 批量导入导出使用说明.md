# 批量导入导出功能使用说明

## 🎯 功能位置

### 1. 批量导入
**位置1：页面顶部**
- 在达人管理页面顶部，"筛选"按钮旁边有一个绿色的"批量导入"按钮
- 点击即可选择文件进行导入，无需先选择达人

**位置2：批量操作弹窗**
- 先选择一个或多个达人（勾选复选框）
- 点击紫色的"批量操作"按钮
- 在弹窗的"数据导入导出"区域点击"批量导入"

### 2. 批量导出
**位置：批量操作弹窗**
- 先选择一个或多个达人（勾选复选框）
- 点击紫色的"批量操作"按钮
- 在弹窗的"数据导入导出"区域选择：
  - "导出CSV" - 适合Excel打开
  - "导出JSON" - 完整数据结构

## 📋 支持的文件格式

### CSV格式要求
```csv
platformId,platformUserId,username,displayName,followersCount,status,email,phone,country,primaryCategory
1,test_user_001,testuser001,测试达人001,15000,POTENTIAL,test001@example.com,+86-13800138001,中国,美妆
1,test_user_002,testuser002,测试达人002,25000,ACTIVE,test002@example.com,+86-13800138002,中国,时尚
```

**必需字段：**
- `platformId` - 平台ID（1=TikTok, 2=抖音等）
- `platformUserId` - 平台用户ID（唯一标识）

**可选字段：**
- `username` - 用户名
- `displayName` - 显示名称
- `followersCount` - 粉丝数量
- `status` - 状态（ACTIVE/INACTIVE/POTENTIAL/BLACKLISTED）
- `email` - 邮箱
- `phone` - 电话
- `country` - 国家
- `primaryCategory` - 主要分类
- 等等...

### JSON格式要求
```json
[
  {
    "platformId": "1",
    "platformUserId": "test_user_001",
    "username": "testuser001",
    "displayName": "测试达人001",
    "followersCount": 15000,
    "status": "POTENTIAL",
    "email": "test001@example.com",
    "phone": "+86-13800138001",
    "country": "中国",
    "primaryCategory": "美妆"
  }
]
```

## 🔄 导入处理逻辑

### 重复数据处理
- **检测标准**：`platformId` + `platformUserId` 组合
- **如果存在**：更新现有记录
- **如果不存在**：创建新记录

### 数据验证
- ✅ 必需字段检查（platformId, platformUserId）
- ✅ 平台ID有效性验证
- ✅ 数据类型转换（字符串→数字→BigInt等）
- ✅ 状态值有效性检查

### 错误处理
- 📊 导入结果统计（新增/更新/错误数量）
- 📝 详细错误报告（显示前10个错误）
- 🔄 事务回滚（发生错误时保护数据完整性）

## 📤 导出功能特性

### CSV导出
- 📊 Excel兼容格式
- 🎯 包含主要字段：ID、用户名、显示名、平台、粉丝数、状态、联系方式等
- 📅 自动生成文件名：`influencers_export_YYYY-MM-DD.csv`

### JSON导出
- 🔍 完整数据结构
- 🏷️ 包含关联标签信息
- 📊 包含统计数据（合作记录数、沟通记录数）
- 📅 导出时间戳

## 🛠️ 使用步骤

### 批量导入步骤
1. **准备数据文件**
   - 下载示例文件：`sample-import.csv`
   - 按照格式要求填写数据
   - 确保必需字段不为空

2. **执行导入**
   - 点击"批量导入"按钮
   - 选择准备好的CSV或JSON文件
   - 等待处理完成

3. **查看结果**
   - 系统显示导入统计
   - 如有错误会显示详细信息
   - 页面自动刷新显示新数据

### 批量导出步骤
1. **选择达人**
   - 勾选要导出的达人复选框
   - 或点击表头全选所有达人

2. **打开批量操作**
   - 点击"批量操作"按钮

3. **选择导出格式**
   - 点击"导出CSV"或"导出JSON"
   - 文件自动下载到本地

## ⚠️ 注意事项

### 数据安全
- 🔒 导入前会验证数据格式
- 🔄 支持事务回滚，确保数据一致性
- 📝 详细的操作日志记录

### 性能考虑
- 📊 建议单次导入不超过1000条记录
- ⏱️ 大文件导入可能需要较长时间
- 💾 导入过程中请勿关闭页面

### 数据格式
- 📝 CSV文件请使用UTF-8编码
- 🔢 数字字段请使用纯数字（不含逗号等分隔符）
- 📅 日期字段使用ISO格式（YYYY-MM-DD）

## 📋 示例文件

项目中包含示例文件：
- `sample-import.csv` - CSV格式示例
- 可以基于此文件修改后导入测试

## 🐛 常见问题

### Q: 导入失败怎么办？
A: 检查文件格式、必需字段、平台ID是否正确

### Q: 重复数据会怎么处理？
A: 系统会自动更新现有记录，不会创建重复数据

### Q: 支持哪些平台ID？
A: 1=TikTok, 2=抖音, 3=快手, 4=小红书等

### Q: 导出的文件在哪里？
A: 文件会自动下载到浏览器默认下载目录

## 🎉 功能完成度

- ✅ CSV格式导入导出
- ✅ JSON格式导入导出  
- ✅ 数据验证和错误处理
- ✅ 重复数据智能处理
- ✅ 完整的用户反馈
- ✅ 事务安全保证

批量导入导出功能已完全实现，可以高效处理大量达人数据！ 